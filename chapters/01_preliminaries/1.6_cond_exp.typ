#import "../../template.typ": kbox, intuition

// 【修改点1】去掉手写的 "1.6"，让 Typst 自动编号
// 如果这是本章第一个二级标题，它会自动变成 "1.1 条件期望"
== 条件期望

条件期望是随机过程后续章节（尤其是鞅论和马尔可夫链）的基础。

#kbox("定义：离散型条件期望")[
  设 $(X, Y)$ 为离散型随机变量，已知 $Y=y$ 时 $X$ 的条件分布律为：
  
  // 【修改点2】Typst 中分数不用 \frac{}{} 或 frac()，直接用 / 即可
  $ P(X=x_i | Y=y_j) = (P(X=x_i, Y=y_j)) / (P(Y=y_j)) $
  
  则在 $Y=y_j$ 条件下 $X$ 的条件期望定义为：
  $ E[X|Y=y_j] = sum_i x_i P(X=x_i | Y=y_j) $
]

#intuition("直观理解：重期望公式 (Tower Property)")[
  对于随机变量 $X$ 和 $Y$，有：
  $ E[E[X|Y]] = E[X] $
  
  *核心思想*：如果我们先根据 $Y$ 的信息对 $X$ 做预测（这本身是个随机变量），然后再对这个预测取平均，结果就等于直接对 $X$ 取平均。
]
