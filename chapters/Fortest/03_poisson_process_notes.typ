#import "../../template.typ": *

// 页面初始化
#show: project.with(
  title: "随机过程复习笔记：泊松过程",
  author: "复习整理",
)

= 2015年真题解析：泊松过程的基本定义

// 对应图1上方的题目与蓝色定义部分
#kbox("问题描述与核心定义")[
  *题目 (2015-3)*：
  以 $N(t)$ 表示时间间隔 $(0, t]$ 内到达某商场的顾客数。设 $\{N(t), t >= 0\}$ 是强度 $lambda > 0$ 的泊松过程。计算：
  1. $P(N_1=0, N_2=1)$
  2. $P(W_1 > 1, W_2 <= 2)$，其中 $W_i$ 代表第 $i$ 个顾客到达的时刻。

  *泊松过程核心性质 (蓝笔笔记)*：
  1. *计数分布*：$P{N(s+t) - N(s) = k} = ((lambda t)^k / k!) e^(- lambda t)$
  2. *初值条件*：$N(0) = 0$
  3. *独立增量*：$N(t_2)-N(t_1)$ 与 $N(t_4)-N(t_3)$ 相互独立 ($t_1 < t_2 < t_3 < t_4$)
  4. *平稳增量*：任意时间间隔 $(s, s+t]$ 内发生事件的次数仅取决于时间长度 $t$，与起始点 $s$ 无关。
]

== 解答过程

*1. 计算 $P(N_1=0, N_2=1)$*

解题思路：利用独立增量性质将联合概率拆解。

$
P(N_1=0, N_2=1) &= P(N(1)-N(0)=0, N(2)-N(1)=1) \
& "（利用独立增量性质拆分）" \
&= P(N(1)-N(0)=0) dot P(N(2)-N(1)=1) \
& "（利用平稳增量公式）" \
&= (((lambda dot 1)^0)/0! e^(- lambda dot 1)) dot (((lambda dot 1)^1)/1! e^(- lambda dot 1)) \
&= e^(- lambda) dot (lambda e^(- lambda)) \
&= lambda e^(- 2 lambda)
$

*2. 计算 $P(W_1 > 1, W_2 <= 2)$*

解题思路：将到达时刻 ($W_t$) 的条件转化为计数过程 ($N(t)$) 的条件。
- $W_1 > 1$：第1个顾客到达时刻大于1 $=> (0, 1]$ 时间段内没人到达 $=> N(1)-N(0)=0$。
- $W_2 <= 2$：第2个顾客到达时刻小于等于2 $=> "截止时刻2，总人数至少为2" => N(2) >= 2$。

结合 $N(1)=0$ 的条件，$N(2) >= 2$ 意味着在 $(1, 2]$ 时间段内至少来了2个人。

$
P(W_1 > 1, W_2 <= 2) &= P(N(1)-N(0)=0, N(2)-N(1) >= 2) \
& "（独立增量）" \
&= P{N(1)-N(0)=0} dot P{N(2)-N(1) >= 2} \
&= e^(- lambda) dot [1 - P(N(2)-N(1) < 2)] \
& "（第2个时间间隔长度为1，考虑最少2个的反面是0个或1个）" \
&= e^(- lambda) dot { 1 - P(N(2)-N(1)=0) - P(N(2)-N(1)=1) } \
&= e^(- lambda) { 1 - ((lambda dot 1)^0)/0! e^(- lambda) - ((lambda dot 1)^1)/1! e^(- lambda) } \
&= e^(- lambda) (1 - e^(- lambda) - lambda e^(- lambda))
$

// 对应图1下方的红笔总结
#exbox("总结：泊松过程解题心法")[
  泊松过程的题目，说到底还是利用 *$N(0)=0$*、*独立增量* 和 *平稳增量* 这三条去“拆”条件，把复杂的联合概率转化为独立的简单概率乘积。
]

= 2016年真题解析：泊松过程的可加性与条件分布

// 对应图2左侧的知识点梳理
#intuition("预备知识 (必考点)")[
  - *泊松分布 PMF*: $P(X=k) = (lambda^k / k!) e^(- lambda)$ ($k=0, 1, 2...$)，其中 $E[X] = D[X] = lambda$。
  - *泊松可加性*: 若 $X_1 ~ P(lambda_1)$， $X_2 ~ P(lambda_2)$ 且相互独立，则 $X_1 + X_2 ~ P(lambda_1 + lambda_2)$。
    - 当 $n$ 很大，$p$ 很小，$n p=lambda$ 常数时，二项分布 $B(n,p)$ 近似于泊松分布。
  - *条件概率公式*: $P(A|B) = P(A B) / P(B)$。
  - *组合数公式*: $C_n^m = (n!) / (m!(n-m)!)$。
]

== 题目描述 (2016-4)
某商场为调查顾客到来的客源情况，考察男女顾客来商场的人数。假设男、女顾客来商场的做数分别独立，且服从参数分别为 $lambda_1$ 与 $lambda_2$ 的泊松过程（本题中 $lambda_1=2, lambda_2=3$）。
1. 求来到时刻 $t$ 时，到达商场的总人数分布。
2. 在已知 $t$ 时刻有50人到达的条件下，试求其中恰有30位女性顾客的概率（及平均有多少个女性顾客）。

== 解答过程

*1. 总人数分布*

设男顾客人数分布为 $N_1(t)$，参数 $lambda_1 = 2$；
设女顾客人数分布为 $N_2(t)$，参数 $lambda_2 = 3$。

由于男女顾客人数分别独立，由 *泊松过程的可加性*：
到达商场的总人数分布 $N(t) = N_1(t) + N_2(t)$ 服从参数为 $lambda = lambda_1 + lambda_2 = 5$ 的泊松过程。

$
P{N(t) = k} = ((5t)^k) / k! e^(- 5t)
$

*2. 条件概率求解*

已知 $t$ 时刻有50人到达 ($N(t)=50$)，求女性顾客为30人 ($N_2(t)=30$) 的概率。

令 $X_2$ 为到达商场的女性人数，$X$ 为到达商场的总人数。
$
P{X_2=30 | X=50} &= (P{X_2=30, X=50}) / P{X=50} \
&= (P{X_2=30, X_1=20}) / P{X=50} \
& "（分子利用独立性拆分，分母利用可加性）" \
&= (P{X_2=30} dot P{X_1=20}) / P{X=50}
$

代入泊松分布公式（注意时间 $t$ 在分子分母中会约掉，计算中可省略或设为1）：

$
"原式" &= ( [((3t)^30)/30! e^(- 3t)] dot [((2t)^20)/20! e^(- 2t)] ) / ( ((5t)^50)/50! e^(- 5t) ) \
&= ( (3^30 dot 2^20) / (30! dot 20!) e^(- 5t) ) / ( (5^50) / 50! e^(- 5t) ) \
& "（$e^(- 5t)$ 相互抵消）" \
&= (50!) / (30! 20!) dot (3^30 2^20) / 5^50 \
&= C_50^30 dot (3/5)^30 dot (2/5)^20
$

*结论*：
该条件分布符合二项分布 $B(n, p)$，其中 $n=50$，$p = lambda_2 / (lambda_1 + lambda_2) = 3/5$。
故平均女性顾客数（期望）为：
$ E[X_2 | X=50] = n p = 50 times 3/5 = 30 "人" $

= 2014年真题解析：事件转化与复杂概率
#kbox("题目描述 (2014-3)")[
  假设设男顾客到达商场的人数服从每分钟1人的泊松过程，女顾客到达商场的人数服从每分钟2人的泊松过程，且相互独立。
  试求：
  1. $n$ 个人到达商场的时间需要多于 $t$ 分钟的概率？（代入 $t=7$ 分钟）
  2. "第2个人在第2分钟内到达" 的概率？

  *参数设定*：
  - 男顾客：$lambda_1 = 1$
  - 女顾客：$lambda_2 = 2$
  - 总人数 $X(t)$：服从 $lambda = lambda_1 + lambda_2 = 3$ 的泊松过程。
]

== 1. $n$ 个人到达时间多于 7 分钟

*核心思路（红笔笔记）*：
"n个人到达商场的时间 ($S_n$) 多于7分钟" 等价于 "7分钟内到达的人数 ($N(7)$) 一定小于 $n$"。

即事件 $\{S_n > t\} <=> \{N(t) < n\}$。

$
P(N(t) < n) &= sum_(k=0)^(n-1) P(N(t)=k) \
&= sum_(k=0)^(n-1) ((lambda t)^k)/k! e^(- lambda t)
$

代入 $lambda = 3, t=7$，得 $lambda t = 21$：
$
P(S_n > 7) = sum_(k=0)^(n-1) (21^k)/k! e^(- 21)
$

== 2. "第2个人在第2分钟内到达" 的概率

*语义转化*：
"第2个人在第2分钟内到达" 意味着：
1. 第2个人到达时刻 $W_2 <= 2$（截止时刻2，总人数至少为2，$N(2) >= 2$）。
2. 第2个人到达时刻 $W_2 > 1$（截止时刻1，总人数不到2个，$N(1) < 2$）。

即求概率 $P(A) = P(N(1) < 2, N(2) >= 2)$。

*分情况讨论（利用独立增量拆分）*：
满足 $N(1) < 2$ 的情况只有两种：$N(1)=0$ 或 $N(1)=1$。

*情况 1：$N(1)=0$ 且 $N(2) >= 2$*
$
& P(N(1)=0, N(2) >= 2) \
&= P(N(1)=0) dot P(N(2)-N(1) >= 2) quad "（独立增量）" \
&= P(N(1)=0) dot [1 - P(N(2)-N(1)=0) - P(N(2)-N(1)=1)] \
& "（注：这里时间间隔长度为 1）" \
&= e^(- lambda) dot [1 - e^(- lambda) - lambda e^(- lambda)]
$

*情况 2：$N(1)=1$ 且 $N(2) >= 2$*
$N(2)$ 既然已经有一个人在前1分钟到了，那么后1分钟 $(1,2]$ 内至少再来1个人即可 ($N(2)-N(1) >= 1$)。
$
& P(N(1)=1, N(2)-N(1) >= 1) \
&= P(N(1)=1, N(2)-N(1) >= 1) \
&= P(N(1)=1) dot P(N(2)-N(1) >= 1) \
&= (lambda e^(- lambda)) dot [1 - e^(- lambda)]
$

*总概率计算*：
将两部分相加（代入 $lambda=3$）：
$
P(A) &= e^(-3)(1 - e^(-3) - 3e^(-3)) + 3e^(-3)(1 - e^(-3)) \
&= e^(-3)(1 - 4e^(-3)) + 3e^(-3) - 3e^(-6) \
&= e^(-3) - 4e^(-6) + 3e^(-3) - 3e^(-6) \
&= 4e^(-3) - 7e^(-6)
$

#intuition("注意")[
  $N(t_2) - N(t_1)$ 服从的是参数为 $lambda (t_2 - t_1)$ 的泊松分布。本题中时间间隔均为1，所以参数都是 $lambda$。
]

= 2011年真题解析：泊松过程的自相关函数

#kbox("题目描述 (2011-2)")[
  设 $\{N(t), t >= 0\}$ 参数为 $lambda$ 的泊松过程。
  计算自相关函数 $E[N(t) N(t+s)]$。
]

== 解答过程

*预备知识（红笔笔记）*：
- $E[N(t)] = lambda t$
- $D[N(t)] = E[N^2(t)] - (E[N(t)])^2 = lambda t quad => E[N^2(t)] = lambda t + (lambda t)^2$
- *关键技巧*：处理 $E[N(t_1) N(t_2)]$ ($t_1 < t_2$) 时，必须利用*独立增量*性质。
  $N(t_2)$ 与 $N(t_1)$ 不独立，但 $N(t_2)-N(t_1)$ 与 $N(t_1)$ 独立。

*推导步骤*：

将 $N(t+s)$ 拆解为 $N(t) + [N(t+s) - N(t)]$：

$
E[N(t) N(t+s)] &= E { N(t) [ N(t) + (N(t+s) - N(t)) ] } \
&= E { N^2(t) + N(t)[N(t+s) - N(t)] } \
&= E[N^2(t)] + E [ N(t) dot (N(t+s) - N(t)) ]
$

利用独立性：
在 $(0, t]$ 内的计数 $N(t)$ 与在 $(t, t+s]$ 内的增量 $N(t+s)-N(t)$ 是相互独立的。
故 $E[X Y] = E[X] E[Y]$：

$
"第二项" &= E[N(t)] dot E[N(t+s) - N(t)] \
&= (lambda t) dot (lambda s) \
&= lambda^2 t s
$

代入第一项 $E[N^2(t)] = lambda t + lambda^2 t^2$：

$
E[N(t) N(t+s)] &= (lambda t + lambda^2 t^2) + lambda^2 t s \
&= lambda t + lambda^2 t (t+s)
$

= 真题补充解析：电话呼叫频率问题

#kbox("题目描述 (手写笔记)")[
  设电话总机在 $(0, t)$ 内接到电话呼叫数 $X(t)$ 是具有强度（每分钟）为 $lambda$ 的泊松过程。求：
  1. 两分钟内接到3次呼叫的概率。
  2. 第2分钟内收到第3次呼叫的概率。
]

== 解答过程

*1. 两分钟内接到3次呼叫的概率*

时间长度 $t=2$，参数为 $lambda dot 2 = 2 lambda$。

$
P(N(2)-N(0)=3) &= ((lambda dot 2)^3) / 3! e^(- lambda dot 2) \
&= (8 lambda^3) / (3 dot 2 dot 1) e^(- 2 lambda) \
&= 4/3 lambda^3 e^(- 2 lambda)
$

*2. 第2分钟内收到第3次呼叫的概率*

设“第2分钟内收到第3次呼叫”为事件 $A$。这意味着：
- 截止 $t=1$ 时，总呼叫数必须少于3次（即 $N(1) in {0, 1, 2}$）。
- 截止 $t=2$ 时，总呼叫数必须至少达到3次（$N(2) >= 3$）。

根据 $N(1)$ 的不同取值，将事件 $A$ 拆分为三种互斥情况：
1. $N(1)=2$，且 $N(2)-N(1) >= 1$ （前1分钟来2个，后1分钟至少来1个）
2. $N(1)=1$，且 $N(2)-N(1) >= 2$ （前1分钟来1个，后1分钟至少来2个）
3. $N(1)=0$，且 $N(2)-N(1) >= 3$ （前1分钟来0个，后1分钟至少来3个）

$
P(A) = & P(N(1)=2, N(2)-N(1)>=1) \
&+ P(N(1)=1, N(2)-N(1)>=2) \
&+ P(N(1)=0, N(2)-N(1)>=3)
$

利用独立增量性质 $P(N(1)=k, N(2)-N(1)>=m) = P(N(1)=k) dot P(N(2)-N(1)>=m)$。
同时注意，#text(fill: blue)[这里使用反面概率计算增量部分：$P(Delta N >= n) = 1 - P(Delta N < n) = 1 - sum_(k=0)^(n-1) ((lambda t)^k)/k! e^(- lambda t)$]。
本题中时间间隔 $t=1$，故参数均为 $lambda$。

*详细推导（严格按照笔记展开）*：

$
P(A) &= underbrace(((lambda dot 1)^2)/2! e^(- lambda), P(N(1)=2)) dot underbrace([1 - ((lambda dot 1)^0)/0! e^(- lambda)], P(Delta N >= 1)) \
&+ underbrace(((lambda dot 1)^1)/1! e^(- lambda), P(N(1)=1)) dot underbrace([1 - ((lambda dot 1)^0)/0! e^(- lambda) - ((lambda dot 1)^1)/1! e^(- lambda)], P(Delta N >= 2)) \
&+ underbrace(((lambda dot 1)^0)/0! e^(- lambda), P(N(1)=0)) dot underbrace([1 - ((lambda dot 1)^0)/0! e^(- lambda) - ((lambda dot 1)^1)/1! e^(- lambda) - ((lambda dot 1)^2)/2! e^(- lambda)], P(Delta N >= 3))
$

化简各项：
$
P(A) &= lambda^2/2 e^(- lambda) (1 - e^(- lambda)) \
&+ lambda e^(- lambda) (1 - e^(- lambda) - lambda e^(- lambda)) \
&+ e^(- lambda) (1 - e^(- lambda) - lambda e^(- lambda) - lambda^2/2 e^(- lambda))
$

展开括号：
$
P(A) &= lambda^2/2 e^(- lambda) - lambda^2/2 e^(- 2 lambda) \
&+ lambda e^(- lambda) - lambda e^(- 2 lambda) - lambda^2 e^(- 2 lambda) \
&+ 1 e^(- lambda) - 1 e^(- 2 lambda) - lambda e^(- 2 lambda) - lambda^2/2 e^(- 2 lambda)
$

合并同类项（提取 $e^(- lambda)$ 和 $e^(- 2 lambda)$）：
$
&= (lambda^2/2 + lambda + 1) e^(- lambda) - (lambda^2/2 + lambda + lambda^2 + 1 + lambda + lambda^2/2) e^(- 2 lambda) \
" " \
& "（注：笔记中的最后一步合并似乎直接给出了结果，我们整理如下）" \
&= 1 - e^(- lambda) - (lambda + 3/2 lambda^2) e^(- 2 lambda)
$